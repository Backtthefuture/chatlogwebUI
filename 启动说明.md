# 启动说明

## 👋 使用前必读（新手专区）

**完全没有编程经验？别担心！** 这个指南就是为你准备的。

### 🎯 这个系统是做什么的？
这是一个**聊天记录分析工具**，可以帮你：
- 📱 查找微信/QQ的历史聊天记录
- 🤖 用AI智能分析聊天内容（比如总结群聊讨论的技术话题）
- 📊 生成漂亮的分析报告

### 🔍 我需要准备什么？
1. **一台电脑**（Windows 或 Mac 都可以）
2. **聊天记录数据**（微信或QQ的聊天数据）
3. **AI服务账号**（DeepSeek 或 Gemini，用来分析聊天内容）
4. **30分钟时间**（按照下面步骤操作）

### 📝 操作难度如何？
- **超级简单**：复制粘贴几行命令就行
- **不需要编程**：全程按照步骤操作即可
- **有图有步骤**：每一步都有详细说明

### 💰 费用说明
- **本工具免费**：这个分析系统完全免费
- **AI服务费用**：AI分析需要付费（通常几块钱能用很久）

**准备好了吗？让我们开始吧！** 👇

---

## 🚀 快速开始

本文档将帮助您快速部署和使用聊天记录查询与AI分析系统。

## 📋 系统要求

### 基础环境
- **Node.js**: 18.0.0 或更高版本
- **npm**: 8.0.0 或更高版本
- **操作系统**: Windows、macOS 或 Linux

### 网络要求
- 需要访问外网（用于AI模型API调用）
- 端口3000需要可用（可在配置中修改）

## 🔧 安装步骤（小白专用详细版）

### 🎯 前置准备 - 安装必需软件

#### 1. 安装 Node.js（必须）
**什么是 Node.js？** - 这是运行我们程序的基础环境，就像安装 Java 才能运行 Java 程序一样。

**安装步骤：**
1. 访问 [Node.js 官网](https://nodejs.org/zh-cn/)
2. 点击下载 **LTS 版本**（左边那个，更稳定）
3. 下载完成后，双击安装包，一路"下一步"即可
4. 安装完成后，验证是否成功：
   - **Windows**: 按 `Win + R`，输入 `cmd`，按回车
   - **Mac**: 按 `Cmd + 空格`，搜索"终端"
   - 在弹出的黑框框（终端）中输入：请在终端输入：node --version
   - 如果显示版本号（如 v18.x.x），说明安装成功！

#### 2. 安装 chatlog 聊天数据服务（必须）
**什么是 chatlog？**
- chatlog 是一款开源的聊天记录提取和服务工具，支持微信聊天数据的解密和API访问。
- 你可以用它把微信聊天记录导出并提供给本系统分析。

**安装步骤：**
1. 访问 [chatlog 项目主页](https://github.com/sjzar/chatlog)
2. 推荐下载“预编译版本”——在页面右侧或 Releases 区找到与你电脑系统对应的安装包（如 Windows、macOS）
3. 下载后解压，得到 `chatlog` 可执行文件
4. （可选）将 `chatlog` 文件放到桌面或任意你容易找到的位置

**首次使用 chatlog 的简单流程：**
1. 双击或在终端运行 `chatlog`，会弹出一个窗口（或命令行界面）
2. 按提示选择“解密数据”，完成微信数据的解密
3. 再选择“开启 HTTP 服务”，保持 chatlog 程序运行，不要关闭
4. 记住 HTTP 服务的端口（默认是 5030），后续系统会自动连接

> 详细操作可参考 [chatlog 官方文档](https://github.com/sjzar/chatlog)

### 📦 详细安装步骤

#### 第1步：下载项目代码

**方法一：使用 Git（推荐）**
1. 在桌面右键，选择"在此处打开终端"（或"Git Bash Here"）
2. 请在终端输入：git clone https://github.com/your-username/chatlog-analysis-system.git
3. 进入项目文件夹：
   请在终端输入：cd chatlog-analysis-system

**方法二：直接下载（如果不会用 Git）**
1. 在 GitHub 项目页面点击绿色的 "Code" 按钮
2. 选择 "Download ZIP"
3. 解压到桌面或任意文件夹
4. 在解压的文件夹中右键 → "在此处打开终端"

#### 第2步：安装项目依赖
> **注意：以下所有命令都需要在项目文件夹（如 chatlog-analysis-system）下执行。**
> 
> 如果你还没有进入项目文件夹，请在终端输入：cd chatlog-analysis-system
请在终端输入：npm install
**等待时间**：可能需要 2-5 分钟，看到很多文字滚动是正常的，请耐心等待！

#### 第3步：启动服务
> **注意：启动服务也必须在项目文件夹下执行。**
请在终端输入：npm start
**成功启动的标志：**
- 看到类似 `服务器已启动，端口: 3000` 的消息
- 没有红色的错误信息
- 终端"卡住"不动了（这是正常的，说明程序在运行）

#### 第4步：打开网页
1. 打开浏览器（Chrome、Edge、Safari 都可以）
2. 在地址栏输入：http://localhost:3000
3. 按回车

### 🎉 成功！如果看到系统界面，说明安装完成！

---

## 💡 新手实用技巧

### ❓ 常见疑问解答

**Q: 终端是什么？黑框框怎么打开？**
- **Windows**: 按 `Win + R`，输入 `cmd` 或 `powershell`
- **Mac**: 按 `Cmd + 空格`，搜索"终端"
- 这就是输入命令的地方，别害怕！

**Q: 如何停止程序？**
- 在运行 `npm start` 的终端中按 `Ctrl + C`

**Q: 如何重新启动？**
1. 先按 `Ctrl + C` 停止
2. 再次输入 `npm start`

**Q: 修改了设置后为什么没生效？**
- 需要重启服务（停止后重新 `npm start`）

**Q: 出现红色错误怎么办？**
- 检查 Node.js 是否正确安装
- 确保在正确的项目文件夹中运行命令
- 查看下面的"故障排除"部分

### 🚨 故障排除

**问题1：`command not found: node`**
- 解决：重新安装 Node.js，确保勾选"添加到 PATH"

**问题2：`npm install` 失败**
- 解决：尝试使用国内镜像：`npm install --registry=https://registry.npmmirror.com`

**问题3：端口 3000 被占用**
- 解决：在 `.env` 文件中修改 `PORT=3001`（或其他数字）

**问题4：无法访问 localhost:3000**
- 检查服务是否真的启动成功
- 尝试 `http://127.0.0.1:3000`
- 检查防火墙设置

## ⚙️ 配置说明（获取AI能力）

### 🤖 为什么需要AI配置？
AI是这个系统的"大脑"，负责分析聊天内容、总结要点、生成报告。就像你需要OpenAI账号才能用ChatGPT一样。

### 💡 选择哪个AI服务？

#### 🌟 DeepSeek（强烈推荐给新手）
**为什么推荐？**
- ✅ 中文支持超好
- ✅ 价格便宜（几块钱能用很久）
- ✅ 注册简单（支持手机号）
- ✅ 分析质量很高

**获取步骤：**
1. 访问 [DeepSeek官网](https://www.deepseek.com/) 
2. 点击"注册"，用手机号注册
3. 登录后点击"API Keys"
4. 点击"创建新的API Key"
5. 复制这个密钥（类似：sk-xxx...）
6. 推荐充值10-20元就够用很久了

#### 🌍 Google Gemini（备选方案）
**特点：**
- ✅ Google出品，技术先进
- ❌ 可能需要科学上网
- ❌ 注册相对复杂

**获取步骤：**
1. 访问 [Google AI Studio](https://aistudio.google.com/)
2. 登录Google账号
3. 创建API Key

### 🔧 如何配置到系统中？

**超级简单的方法：**
1. 确保系统已启动（看到网页界面）
2. 点击页面顶部的"⚙️ 模型设置"按钮
3. 选择"DeepSeek"
4. 把刚才复制的API Key粘贴进去
5. 模型选择"deepseek-chat"
6. 点击"🧪 测试连接"（如果成功会显示绿色✅）
7. 点击"💾 保存设置"

**恭喜！现在你可以使用AI分析功能了！** 🎉

### 💸 费用参考
- **DeepSeek**: 大约1元能分析几万字聊天记录
- **Gemini**: 有免费额度，超出后按使用量计费

### 🔐 安全提醒
- API Key就像银行卡密码，不要泄露给别人
- 只在官方网站获取API Key
- 定期检查使用量，避免超额费用

## 📁 聊天数据准备

### 数据格式要求
系统需要连接到聊天记录数据源。请确保：

1. **chatlog 聊天数据服务已正确安装并运行**：请先完成上方“安装 chatlog 聊天数据服务”并启动 HTTP 服务
2. **数据源运行正常**：聊天记录服务需要在后台运行（即 chatlog 程序不能关闭）
3. **数据格式标准**：支持微信、QQ等常见聊天格式
4. **权限配置**：确保系统有权限访问聊天数据

> 如果你还没有解密微信数据，请先用 chatlog 工具完成解密和服务启动

### 数据源连接
- 系统会自动检测聊天服务连接状态
- 如果连接失败，会显示详细的错误信息和解决建议
- 支持自动重试机制，确保连接稳定

## 🎯 功能使用指南

### 1. 基础查询
- **时间范围**：选择查询的时间段
- **联系人筛选**：选择特定的联系人或群聊
- **关键词搜索**：在对话内容中搜索关键词
- **数据量控制**：选择返回的记录数量（100-10000条或无限制）

### 2. AI智能分析
#### 预设分析模板
- **编程技术讨论分析**：分析技术交流内容
- **科学学习内容分析**：总结学习讨论要点
- **阅读讨论分析**：分析读书分享内容

#### 自定义分析
- 输入自定义提示词
- 根据具体需求定制分析维度
- 支持多轮对话分析

#### 批量分析
- 一键分析多个群聊
- 自动生成综合报告
- 支持定时分析任务

### 3. 定时任务
1. 进入"定时分析管理"区域
2. 配置执行时间（支持Cron表达式）
3. 添加要分析的群聊和分析项
4. 启用定时任务

## 🐛 常见问题

### Q1: 无法连接到聊天服务
**解决方案**：
- 检查聊天记录服务是否正常运行
- 确认网络连接正常
- 查看浏览器控制台的具体错误信息

### Q2: AI分析失败
**解决方案**：
- 检查API Key是否正确配置
- 测试AI模型连接状态
- 确认有足够的API调用余额
- 检查网络是否能访问AI服务

### Q3: 页面加载缓慢
**解决方案**：
- 减少查询的数据量
- 选择更小的时间范围
- 检查服务器性能

### Q4: 定时任务不执行
**解决方案**：
- 检查Cron表达式格式是否正确
- 确认定时任务已启用
- 查看系统日志获取详细信息

## 🔒 安全注意事项

1. **API Key安全**：
   - 不要将API Key提交到公共代码仓库
   - 定期更换API Key
   - 使用环境变量存储敏感信息

2. **数据隐私**：
   - 聊天数据仅在本地处理
   - AI分析结果可选择是否保存
   - 定期清理不需要的分析历史

3. **网络安全**：
   - 建议在内网环境使用
   - 如需公网访问，请配置适当的安全措施
   - 定期更新依赖包

## 📚 开发文档

### 项目结构
```
chatlog-analysis-system/
├── public/          # 静态资源
├── views/           # 页面模板
├── routes/          # API路由
├── utils/           # 工具函数
├── config/          # 配置文件
├── package.json     # 项目依赖
└── app.js          # 应用入口
```

### API接口
详见项目根目录的 `项目说明.md` 文件中的API接口文档。

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

1. Fork项目
2. 创建功能分支：`git checkout -b feature/your-feature`
3. 提交更改：`git commit -am 'Add your feature'`
4. 推送分支：`git push origin feature/your-feature`
5. 提交Pull Request

## 📄 许可证

本项目采用 MIT 许可证。详见 [LICENSE](LICENSE) 文件。

## 📞 技术支持

如遇到问题，请：
1. 查看本文档的常见问题部分
2. 搜索已有的Issues
3. 提交新的Issue并提供详细信息

---

**祝您使用愉快！** 🎉 